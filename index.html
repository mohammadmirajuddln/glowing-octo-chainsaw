
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Bank - Reward App</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel CDNs -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background: #020617;
            color: #f8fafc;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: radial-gradient(circle at 50% 50%, #0f172a 0%, #020617 100%);
            overflow: hidden;
        }
        .particle {
            position: absolute;
            background: rgba(34, 211, 238, 0.2);
            border-radius: 50%;
            filter: blur(2px);
            animation: float 20s infinite linear;
        }
        @keyframes float {
            0% { transform: translateY(0) translateX(0); }
            100% { transform: translateY(-100vh) translateX(50vw); }
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body>
    <div id="root"></div>
    <div class="particles">
        <div class="particle" style="width: 100px; height: 100px; left: 10%; bottom: -100px; animation-duration: 15s;"></div>
        <div class="particle" style="width: 50px; height: 50px; left: 40%; bottom: -100px; animation-duration: 25s; animation-delay: 5s;"></div>
        <div class="particle" style="width: 80px; height: 80px; left: 70%; bottom: -100px; animation-duration: 20s; animation-delay: 2s;"></div>
        <div class="particle" style="width: 30px; height: 30px; left: 85%; bottom: -100px; animation-duration: 30s;"></div>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;

        // --- Constants & Types ---
        const ADMIN_PASSWORD = 'mdmiraj%à§³';
        const TELEGRAM_BOT_TOKEN = '7892120485:AAH6v_09p7X6o_U_qWz-S9j-Y_fVq_9_f-Y';
        const TELEGRAM_CHAT_ID = '123456789'; // à¦†à¦ªà¦¨à¦¾à¦° à¦šà§à¦¯à¦¾à¦Ÿ à¦†à¦‡à¦¡à¦¿ à¦¦à¦¿à¦¨

        const View = {
            HOME: 'home',
            WITHDRAW: 'withdraw',
            PROFILE: 'profile',
            ADMIN: 'admin',
            AUTH: 'auth'
        };

        // --- Utilities ---
        const sendTelegram = async (req) => {
            const message = `ðŸš¨ NEW WITHDRAWAL ðŸš¨\nUser: ${req.userName}\nAmount: à§³${req.amount}\nMethod: ${req.method}\nNumber: ${req.number}\nTime: ${new Date(req.timestamp).toLocaleString()}`;
            try {
                await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: TELEGRAM_CHAT_ID, text: message })
                });
            } catch (e) { console.error(e); }
        };

        // --- Components ---
        const GlassCard = ({ children, className = "" }) => (
            <div className={`glass rounded-3xl p-6 shadow-xl ${className}`}>{children}</div>
        );

        const BottomNav = ({ activeView, setActiveView }) => {
            const items = [
                { id: View.HOME, label: 'Home', icon: 'M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6' },
                { id: View.WITHDRAW, label: 'Withdraw', icon: 'M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z' },
                { id: View.PROFILE, label: 'Profile', icon: 'M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z' },
            ];
            return (
                <div className="fixed bottom-6 left-1/2 -translate-x-1/2 w-[90%] max-w-sm glass rounded-2xl flex justify-around items-center p-3 z-50 shadow-2xl">
                    {items.map(i => (
                        <button key={i.id} onClick={() => setActiveView(i.id)} className={`flex flex-col items-center gap-1 transition-all ${activeView === i.id ? 'text-cyan-400 scale-110' : 'text-slate-400'}`}>
                            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d={i.icon}/></svg>
                            <span className="text-[10px] font-bold uppercase">{i.label}</span>
                        </button>
                    ))}
                </div>
            );
        };

        // --- Main Views ---
        const AuthView = ({ onAuth, allUsers, setAllUsers }) => {
            const [name, setName] = useState('');
            const [ref, setRef] = useState('');
            const handle = () => {
                if (name.length < 3) return alert('Name too short');
                const existing = allUsers.find(u => u.name === name);
                if (existing) return onAuth(existing);
                
                const newUser = {
                    id: Date.now().toString(), name, balance: 0, referralsCount: 0, withdrawalCount: 0,
                    referralCode: Math.random().toString(36).substring(2, 8).toUpperCase(),
                    isBanned: false, joinDate: Date.now()
                };
                
                let updated = [...allUsers];
                if (ref) {
                    const idx = allUsers.findIndex(u => u.referralCode === ref.toUpperCase());
                    if (idx !== -1) {
                        updated[idx].balance += 5;
                        updated[idx].referralsCount += 1;
                    }
                }
                updated.push(newUser);
                setAllUsers(updated);
                onAuth(newUser);
            };
            return (
                <div className="flex flex-col items-center justify-center min-h-[80vh] gap-8">
                    <h1 className="text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-600">AD BANK</h1>
                    <GlassCard className="w-full">
                        <input value={name} onChange={e => setName(e.target.value)} className="w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 mb-4 text-white" placeholder="Name" />
                        <input value={ref} onChange={e => setRef(e.target.value)} className="w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 mb-6 text-white uppercase" placeholder="Referral Code" />
                        <button onClick={handle} className="w-full bg-gradient-to-r from-cyan-500 to-blue-600 py-4 rounded-xl font-bold">START EARNING</button>
                    </GlassCard>
                </div>
            );
        };

        const Dashboard = ({ user, onUpdate, images }) => {
            const [cooldown, setCooldown] = useState(0);
            const [scratched, setScratched] = useState(false);
            useEffect(() => {
                if (user.lastScratch) {
                    const rem = Math.max(0, 30000 - (Date.now() - user.lastScratch));
                    setCooldown(Math.ceil(rem / 1000));
                }
            }, [user.lastScratch]);
            useEffect(() => {
                let t; if (cooldown > 0) t = setInterval(() => setCooldown(c => c - 1), 1000);
                return () => clearInterval(t);
            }, [cooldown]);
            const scratch = () => {
                if (cooldown > 0 || scratched) return;
                setScratched(true);
                setTimeout(() => {
                    onUpdate({ ...user, balance: user.balance + 1, lastScratch: Date.now() });
                    setCooldown(30);
                }, 1000);
            };
            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <div><h2 className="text-xl font-bold">à§³{user.balance}</h2><p className="text-[10px] text-cyan-400">BALANCE</p></div>
                        <div className="text-right"><h2 className="text-xl font-bold">{user.referralCode}</h2><p className="text-[10px] text-slate-500">REF CODE</p></div>
                    </div>
                    <GlassCard className="text-center">
                        <h3 className="mb-4 font-black">SCRATCH & EARN</h3>
                        <div onClick={scratch} className="relative aspect-video bg-slate-800 rounded-2xl flex items-center justify-center cursor-pointer overflow-hidden">
                            {!scratched ? <div className="z-10 text-xs font-bold">TAP TO SCRATCH</div> : <div className="text-2xl font-black text-green-400">à§³1 ADDED!</div>}
                            <img src={images[0]?.url || 'https://picsum.photos/400/250'} className="absolute inset-0 w-full h-full object-cover opacity-20" />
                        </div>
                        {cooldown > 0 && <p className="mt-4 text-xs text-cyan-400 font-bold">NEXT IN {cooldown}s</p>}
                        {scratched && cooldown === 0 && <button onClick={() => setScratched(false)} className="mt-4 text-xs underline">SCRATCH AGAIN</button>}
                    </GlassCard>
                </div>
            );
        };

        const WithdrawView = ({ user, onUpdate, addWithdrawal }) => {
            const [num, setNum] = useState('');
            const [amt, setAmt] = useState('');
            const [method, setMethod] = useState('bKash');
            const submit = () => {
                const val = parseFloat(amt);
                if (user.withdrawalCount === 0 && val < 10) return alert('Min 1st withdraw à§³10');
                if (user.withdrawalCount > 0 && val < 500) return alert('Min subsequent withdraw à§³500');
                if (val > user.balance) return alert('Insufficient balance');
                if (user.withdrawalCount > 0 && user.balance < 5000 && user.referralsCount < 10) return alert('10 Referrals required');
                
                const req = { id: Date.now().toString(), userName: user.name, amount: val, method, number: num, timestamp: Date.now() };
                sendTelegram(req);
                onUpdate({ ...user, balance: user.balance - val, withdrawalCount: user.withdrawalCount + 1 });
                addWithdrawal(req);
                alert('Success!');
            };
            return (
                <div className="space-y-6">
                    <h2 className="text-2xl font-bold">Withdraw</h2>
                    <GlassCard>
                        <div className="flex gap-2 mb-4">
                            {['bKash', 'Nagad', 'Rocket'].map(m => (
                                <button key={m} onClick={() => setMethod(m)} className={`flex-1 py-2 rounded-lg text-[10px] font-bold border ${method === m ? 'border-cyan-500 bg-cyan-500/10' : 'border-slate-700'}`}>{m}</button>
                            ))}
                        </div>
                        <input value={num} onChange={e => setNum(e.target.value)} className="w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 mb-4" placeholder="Number" />
                        <input value={amt} onChange={e => setAmt(e.target.value)} className="w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 mb-6" placeholder="Amount" />
                        <button onClick={submit} className="w-full bg-cyan-500 py-4 rounded-xl font-bold">SUBMIT</button>
                    </GlassCard>
                </div>
            );
        };

        const ProfileView = ({ user, onLogout, openAdmin }) => {
            const [pass, setPass] = useState('');
            const [show, setShow] = useState(false);
            return (
                <div className="space-y-6 text-center">
                    <div className="w-20 h-20 bg-cyan-500 rounded-full mx-auto flex items-center justify-center text-3xl font-black">{user.name[0]}</div>
                    <h2 className="text-xl font-bold">{user.name}</h2>
                    <GlassCard className="text-left space-y-3">
                        <div className="flex justify-between text-xs"><span>Referrals</span><span>{user.referralsCount}</span></div>
                        <div className="flex justify-between text-xs"><span>Withdrawals</span><span>{user.withdrawalCount}</span></div>
                    </GlassCard>
                    <button onClick={onLogout} className="text-red-400 text-xs font-bold">LOGOUT</button>
                    <div className="mt-10 opacity-10" onClick={() => setShow(true)}>ADMIN ACCESS</div>
                    {show && <div className="fixed inset-0 bg-black/90 flex items-center justify-center p-6 z-[100]">
                        <GlassCard className="w-full">
                            <input type="password" value={pass} onChange={e => setPass(e.target.value)} className="w-full bg-slate-900 p-4 mb-4" placeholder="Key" />
                            <button onClick={() => pass === ADMIN_PASSWORD ? openAdmin() : alert('Wrong')} className="w-full bg-red-600 p-4 rounded-xl">LOGIN</button>
                            <button onClick={() => setShow(false)} className="mt-4 text-xs">CANCEL</button>
                        </GlassCard>
                    </div>}
                </div>
            );
        };

        const AdminPanel = ({ users, setUsers, images, setImages, onBack }) => {
            const deleteUser = (id) => setUsers(users.filter(u => u.id !== id));
            return (
                <div className="space-y-6">
                    <button onClick={onBack} className="text-xs">BACK</button>
                    <h2 className="text-xl font-bold">Admin Console</h2>
                    <div className="space-y-2">
                        {users.map(u => (
                            <div key={u.id} className="glass p-3 flex justify-between items-center text-xs">
                                <span>{u.name} (à§³{u.balance})</span>
                                <button onClick={() => deleteUser(u.id)} className="text-red-500">DEL</button>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // --- App Engine ---
        const App = () => {
            const [view, setView] = useState(View.AUTH);
            const [user, setUser] = useState(null);
            const [allUsers, setAllUsers] = useState(() => JSON.parse(localStorage.getItem('ad_users') || '[]'));
            const [images, setImages] = useState(() => JSON.parse(localStorage.getItem('ad_images') || '[{"id":"1","url":"https://picsum.photos/400/250"}]'));
            const [withdrawals, setWithdrawals] = useState(() => JSON.parse(localStorage.getItem('ad_withdrawals') || '[]'));

            useEffect(() => {
                localStorage.setItem('ad_users', JSON.stringify(allUsers));
                localStorage.setItem('ad_images', JSON.stringify(images));
                localStorage.setItem('ad_withdrawals', JSON.stringify(withdrawals));
            }, [allUsers, images, withdrawals]);

            const updateU = (u) => {
                setUser(u);
                setAllUsers(prev => prev.map(p => p.id === u.id ? u : p));
            };

            return (
                <div className="max-w-md mx-auto min-h-screen p-4 pb-24">
                    {view === View.AUTH && <AuthView onAuth={(u) => { setUser(u); setView(View.HOME); }} allUsers={allUsers} setAllUsers={setAllUsers} />}
                    {user && (
                        <>
                            {view === View.HOME && <Dashboard user={user} onUpdate={updateU} images={images} />}
                            {view === View.WITHDRAW && <WithdrawView user={user} onUpdate={updateU} addWithdrawal={w => setWithdrawals([...withdrawals, w])} />}
                            {view === View.PROFILE && <ProfileView user={user} onLogout={() => { setUser(null); setView(View.AUTH); }} openAdmin={() => setView(View.ADMIN)} />}
                            {view === View.ADMIN && <AdminPanel users={allUsers} setUsers={setAllUsers} images={images} setImages={setImages} onBack={() => setView(View.PROFILE)} />}
                            {view !== View.ADMIN && <BottomNav activeView={view} setActiveView={setView} />}
                        </>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
